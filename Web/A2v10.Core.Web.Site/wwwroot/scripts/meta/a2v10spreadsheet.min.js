!function(t){"function"==typeof define&&define.amd?define(t):t()}((function(){"use strict";const t=t=>t>=26?String.fromCharCode(Math.floor(t/26)+64)+String.fromCharCode(t%26+65):String.fromCharCode(t+65),e=t=>t+"px",s=23;function i(t){const e=t.match(/^([A-Z]+)(\d+)$/);if(!e)throw new Error(`Invalid cell reference: ${t}`);const s=e[1],i=parseInt(e[2],10);let o=0;for(let t=0;t<s.length;t++)o*=26,o+=s.charCodeAt(t)-64;return{r:i,c:o-1}}function o(t){return Math.round(1.33333*t*100)/100}function l(t){return.75*t}class r{constructor(t){this.styles=t,this.stylesMap=Object.keys(this.styles).reduce(((t,e)=>{let s=this.styles[e];return t[this.styleHashCode(s)]=e,t}),{})}defaultStyle(){return{}}styleHashCode(t){if(!t)return"-";return`${t.Bold?"B":"-"}:${t.Italic?"I":"-"}:${t.FontSize?`FS${t.FontSize}`:"-"}:${t.Align?t.Align[0]:"-"}:${t.VAlign?t.VAlign[0]:"-"}:${t.Border||"-"}:${t.BackgroundColor?`BG${t.Background}`:"-"}`}cellClass(t){let e=this.styles[t],s="";return e?(e.Bold&&(s+=" c-bold"),e.Italic&&(s+=" c-italic"),e.Align&&(s+=` c-text-${e.Align.toLowerCase()}`),e.VAlign&&(s+=` c-align-${e.VAlign.toLowerCase()}`),s):s}cellStyle(t){let e=this.styles[t],s={};if(!e)return s;function i(t,e){(e=+e)&&(.2===e?s[t]="1px solid black":1===e&&(s[t]="2px solid black"))}if(e.FontSize&&(s.fontSize=`${e.FontSize}pt`),e.FontName&&(s.fontFamily=e.FontName,console.dir(s)),e.Border){let t=e.Border.split(",");1===t.length?.2==+t[0]?s.border="1px solid black":1==+t[0]&&(s.border="3px solid black"):4===t.length&&(i("borderTop",t[0]),i("borderRight",t[1]),i("borderBottom",t[2]),i("borderLeft",t[3]))}return e.Background&&(s.backgroundColor="#"+e.Background),s}cellStyle2(t){let e=this.styles[t],s={};return e?(e.FontSize&&(s.fontSize=`${e.FontSize}pt`),e.FontName&&(s.fontFamily=e.FontName),e.Background&&(s.backgroundColor="#"+e.Background),s):s}appendNewStyle(t,e){let s=function(t){let e=1;for(;t.hasOwnProperty(`S${e}`);)e++;return`S${e}`}(this.styles);return Vue.set(this.styles,s,t),this.stylesMap[e]=s,s}setStyleProp(t,e,s){let i=Object.assign({},this.styles[t]||this.defaultStyle());i[e]=s;let o=this.styleHashCode(i);if("-:-:-:-:-:-"!==o)return this.stylesMap[o]||this.appendNewStyle(i,o)}}Vue.component("a2-scroll-bar",{template:'\n<div class="a2-sb" :class="sbClass">\n\t<button @click.stop=dec :disabled=decDisabled v-text=decLabel></button>\n\t<div class="sb-body" @click.self="clickBody" ref=body>\n\t\t<div class="thumb" @pointerdown.self.stop=thumbDown\n\t\t\t@pointerup.self.stop=thumbUp @pointermove.self.stop=thumbMove\n\t\t\t:style=thumbStyle :class="{horz: horz, vert: !horz }"></div>\n\t</div>\n\t<button @click.stop=inc :disabled=incDisabled v-text=incLabel></button>\n</div>\n',props:{horz:Boolean,page:Number,pos:Number,min:Number,max:Number,setPos:Function},data:()=>({tempClientSize:0,moving:!1,delta:0,thumbMovePos:0}),computed:{sbClass(){return this.horz?"horz":"vert"},thumbPos(){if(this.moving)return this.thumbMovePos;return this.clientSize/this.size*(this.pos-this.min)},size(){return this.max-this.min},clientSize(){let t=this.tempClientSize;return this.$refs.body&&(t=this.horz?this.$refs.body.clientWidth:this.$refs.body.clientHeight),t},thumbSize(){let t=this.clientSize;return this.page*t/this.size},thumbStyle(){return this.horz?{left:e(this.thumbPos),width:e(this.thumbSize)}:{top:e(this.thumbPos),height:e(this.thumbSize)}},decDisabled(){return this.pos<=this.min},incDisabled(){return this.pos>=this.max-this.page},decLabel(){return this.horz?"◂":"▴"},incLabel(){return this.horz?"▸":"▾"}},methods:{dec(){this.setPosCheck(this.pos-1)},inc(){this.setPosCheck(this.pos+1)},setPosCheck(t){t<this.min&&(t=this.min),t>this.max-this.page&&(t=this.max-this.page),this.setPos(t)},clickBody(t){let e=0;e=(this.horz?t.offsetX:t.offsetY)<this.thumbPos?this.pos-this.page:this.pos+this.page,this.setPosCheck(e)},thumbDown(t){t.target.setPointerCapture(t.pointerId),this.delta=this.hors?t.offsetX:t.offsetY,this.thumbMovePos=this.thumbPos,this.moving=!0},thumbMove(t){if(!this.moving)return;let e=this.$refs.body.getBoundingClientRect(),s=this.horz?t.clientX-this.delta-e.left:t.clientY-this.delta-e.top;s<0&&(s=0);let i=this.thumbSize,o=this.horz?e.width-i:e.height-i;s>o&&(s=o),this.thumbMovePos=s},thumbUp(t){t.target.releasePointerCapture(t.pointerId);let e=this.thumbMovePos;this.moving=!1;let s=this.clientSize/(this.max-this.min),i=Math.min(+(e/s).toFixed(),this.max-this.page);this.setPosCheck(i+this.min)}},mounted(){this.tempClientSize=this.horz?this.$refs.body.clientWidth:this.$refs.body.clientHeight}});var n={data:()=>({rType:"",rItem:-1,rPt:-1,rSize:-1,delta:0}),methods:{clearData(){this.rType="",this.rItem=-1,this.rSize=0,this.rPt=0,this.delta=0},onUp(t,e){if(t.target.releasePointerCapture(t.pointerId),t.stopPropagation(),this.rItem<0)return;let s=this.rPt-this.rSize;s<5&&(s=5),e(s),this.clearData()},hMouseDown(t){t.stopPropagation();let e=this.$parent.pointFromEvent(t),s=this.$parent.colFromPoint(e.x);s&&(t.target.setPointerCapture(t.pointerId),this.rType="C",this.rItem=s.col,this.rPt=s.left+s.width,this.rSize=s.left,this.delta=this.rPt-t.clientX)},hMouseUp(t){this.onUp(t,(t=>{let e=l(t),s=this.$parent.getOrCreateColumn(this.rItem);Vue.set(s,"Width",e)}))},hMouseMove(t){this.rItem<0||(this.rPt=t.clientX+this.delta)},vMouseDown(t){t.stopPropagation();let e=this.$parent.pointFromEvent(t),s=this.$parent.rowFromPoint(e.y);s&&(t.target.setPointerCapture(t.pointerId),this.rType="R",this.rItem=s.row,this.rPt=s.top+s.height,this.rSize=s.top,this.delta=this.rPt-t.clientY)},vMouseUp(t){this.onUp(t,(t=>{let e=this.$parent.getOrCreateRow(this.rItem);Vue.set(e,"Height",l(t))}))},vMouseMove(t){this.rItem<0||(this.rPt=t.clientY+this.delta)}},render(i){let o=this.$parent,l=o.sheet,r=o.$refs.container;if(!r)return;let n=r.clientWidth,h=r.clientHeight,c=[],a=this,d=o.startX,p={right:0,bottom:0};return o.headers?(c.push(i("div",{class:"r-top"})),function(){let s=d;for(const r of o.renderedColumns()){let h=t(r),d=o.colWidth(r),p="thc";if(o.isInSelection(((t,e)=>r>=t.left&&r<=t.left+(e?.ColSpan-1||0)))&&(p+=" thc-sel"),r===l.ColumnCount-1&&(p+=" last",d+=1),c.push(i("div",{class:p,style:{width:e(d),left:e(s)}},[h,i("div",{class:"h-size no-me",on:{pointerdown:a.hMouseDown,pointerup:a.hMouseUp,pointermove:a.hMouseMove}})])),s+=d,s>=n)break}p.right=s-32-1}(),function(){let t=s;for(const s of o.renderedRows()){let r=o.rowHeight(s),n="thr";if(o.isInSelection(((t,e)=>s>=t.top&&s<=t.top+(e?.RowSpan-1||0)))&&(n+=" thr-sel"),s===l.RowCount-1&&(n+=" last",r+=1),c.push(i("div",{class:n,style:{height:e(r),top:e(t)}},[""+(s+1),i("div",{class:"v-size no-me",on:{pointerdown:a.vMouseDown,pointerup:a.vMouseUp,pointermove:a.vMouseMove}})])),t+=r,t>=h)break}p.bottom=t-s-1}()):o.gridLines&&console.dir("calc maxPos"),o.gridLines&&(function(){let t=d;for(const s of o.renderedColumns()){if(t+=o.colWidth(s),t>=n)break;let r="vline";s==l.FixedColumns-1&&(r+=" freeze"),c.push(i("div",{class:r,style:{left:e(t),height:e(p.bottom)}}))}}(),function(){let t=s;for(const s of o.renderedRows()){if(t+=o.rowHeight(s),t>=h)break;let r="hline";s===l.FixedRows-1&&(r+=" freeze"),c.push(i("div",{class:r,style:{top:e(t),width:e(p.right)}}))}}()),this.rItem>=0&&("C"==this.rType?c.push(i("div",{class:"h-resize-line",style:{left:e(this.rPt)}})):c.push(i("div",{class:"v-resize-line",style:{top:e(this.rPt)}}))),i("div",{class:"canvas"},c)}},h={render(i){let o=this.$parent,l=o.sheet,r=o.$refs.container;if(!r)return;let n=r.clientWidth,h=r.clientHeight,c=[],a=s;const d=o.startX;for(const s of o.renderedRows()){let r=d,p=this.$parent.rowHeight(s);for(const h of o.renderedColumns()){let d=t(h),u=o.colWidth(h);const f=`${d}${s+1}`;let m=l.Cells[f];if(m){let t=u,l=p,n="cell"+o.cellClass(m),d=o.cellStyle(m);if(m.ColSpan>1||m.RowSpan>1){for(let e=1;e<m.ColSpan;e++)t+=o.colWidth(e+h);for(let t=1;t<m.RowSpan;t++)l+=o.rowHeight(t+s);n+=" span";let d={left:e(r+1),top:e(a+1),width:e(t-1),height:e(l-1)};c.push(i("div",{class:"cell-ph",style:d}))}c.push(i("div",{class:n,style:Object.assign({left:e(r),top:e(a),width:e(t+1),height:e(l+1)},d),on:{pointerdown:t=>this.clickPh(h,s,m,t)}},m.Value))}if(r+=u,r>=n)break}if(a+=p,a>=h)break}return i("div",{class:"cells"},c)},methods:{clickPh(t,e,s,i){i.preventDefault(),i.stopPropagation(),this.$parent.$selectCell(t,e,s)}}},c={render(t){let s=this.$parent.selection,i=[];for(let o=0;o<s.length;o++){let l=s[o],r=this.$parent.selRect(l);if(r&&r.left>=0&&r.top>=0){for(let t=l.left+1;t<l.right;t++)r.width+=this.$parent.colWidth(t);for(let t=l.top+1;t<l.bottom;t++)r.height+=this.$parent.rowHeight(t);let s="sel";(l.bottom>l.top+1||l.right>l.left+1)&&(s+=" multiply"),i.push(t("div",{class:s,style:{left:e(r.left),top:e(r.top),width:e(r.width+1),height:e(r.height+1)}}))}}return t("div",{class:"selections"},i)}},a={methods:{blur(t){this.$parent.endEdit(t.target.innerText)}},render(s){let i=this.$parent,o=i.editRect,l=`${t(o.c)}${o.r+1}`,r=i.sheet.Cells[l];return s("div",{class:"input cell cell-edit no-me"+i.cellClass(r),style:Object.assign({left:e(o.l+1),top:e(o.t+1),width:e(o.w-1),height:e(o.h-1)},i.cellStyle2(r)),domProps:{contentEditable:!0},on:{blur:this.blur}},i.editText)},mounted(){this.$el.focus(),this.$el.spellcheck=!1}};var d={template:"\n<div class=\"toolbar ss-toolbar\">\n\t<button @click=\"toggleBool('Bold')\" :class=\"{checked: isChecked('Bold', true)}\">B</button>\n\t<button @click=\"toggleBool('Italic')\" :class=\"{checked: isChecked('Italic', true)}\">I</button>\n\t<span>|</span>\n\t<button @click=\"setProp('Align', '')\" :class=\"{checked: isCheckedProp('Align', '')}\">L</button>\n\t<button @click=\"setProp('Align', 'Center')\" :class=\"{checked: isCheckedProp('Align', 'Center')}\">C</button>\n\t<button @click=\"setProp('Align', 'Right')\" :class=\"{checked: isCheckedProp('Align', 'Right')}\">R</button>\n\t<span>|</span>\n\t<button @click=\"setProp('VAlign', '')\" :class=\"{checked: isCheckedProp('VAlign', '')}\">T</button>\n\t<button @click=\"setProp('VAlign', 'Middle')\" :class=\"{checked: isCheckedProp('VAlign', 'Middle')}\">M</button>\n\t<button class=\"btn btn-tb\" @click=\"setProp('VAlign', 'Bottom')\" :class=\"{checked: isCheckedProp('VAlign', 'Bottom')}\"><i class=\"ico ico-copy\" /></button>\n</div>\n",props:{},methods:{isChecked(t,e){return this.$parent.$getSelProp(t,e)},isCheckedProp(t,e){return(this.$parent.$getSelProp(t)||"")===e},toggleBool(t){this.$parent.$setSelProp(t,!this.isChecked(t))},setProp(t,e){this.$parent.$setSelProp(t,e)}}};Vue.component("a2-spreadsheet",{template:'\n<div class="ss-container" :class="{editable}">\n\t<ss-toolbar v-if="editable" />\n\t<div class="ss-body" :key=updateCount ref=container tabindex=0 :style=bodyStyle\n\t\t@pointerup=pointerup @pointerdown=pointerdown @pointermove=pointermove\n\t\t@dblclick=dblclick @keydown.self.stop=keydown @wheel.prevent=mousewheel>\n\t\t<ss-canvas />\n\t\t<ss-rows-combo v-if="rowsCombo" />\n\t\t<ss-cells />\n\t\t<ss-selection />\n\t\t<ss-edit v-if=editing text=editText />\n\t</div>\n\t<a2-scroll-bar class="no-me" :horz=true :min="sheet.FixedColumns || 0" :max="sheet.ColumnCount"\n\t\t:pos="scrollPos.x" :page="hScrollPageSize()"" :setPos=setPosX></a2-scroll-bar>\n\t<a2-scroll-bar class="no-me" :horz=false :min="sheet.FixedRows || 0" :max="sheet.RowCount"\n\t\t:pos="scrollPos.y" :page="vScrollPageSize()" :setPos=setPosY></a2-scroll-bar>\n</div>\n',components:{"ss-canvas":n,"ss-cells":h,"ss-selection":c,"ss-edit":a,"ss-toolbar":d},props:{report:Object,gridLines:{type:Boolean,default:!0},headers:{type:Boolean,default:!0},rowsCombo:Boolean,editable:{type:Boolean,default:!0}},data:()=>({updateCount:0,scrollPos:{x:0,y:0},editing:!1,selecting:!1,editRect:{l:0,t:0,w:0,h:0,c:"",r:-1},editText:"",selStart:{c:0,r:0},selection:[]}),computed:{sheet(){return this.report.Workbook},startX(){return 32+(this.rowsCombo?75:0)},bodyStyle(){return console.dir(this.sheet),{fontFamily:this.report.FontFamily,fontSize:`${this.sheet.FontSize}pt`}}},methods:{rowFromPoint(t){let e=s;for(const s of this.renderedRows()){let i=this.rowHeight(s);if(t>=e&&t<=e+i)return{row:s,top:e,height:i};e+=i}return null},colFromPoint(t){let e=this.startX;for(const s of this.renderedColumns()){let i=this.colWidth(s);if(t>=e&&t<=e+i)return{col:s,left:e,width:i};e+=i}return null},colWidth(e){let s=this.sheet.Columns[t(e)],i=this.sheet.ColumnWidth??54;return s&&s.Width&&(i=-1==s.Width?70:s.Width),o(i)},rowHeight(t){let e=this.sheet.Rows[t+1],s=this.sheet.RowHeight??15;return e&&e.Height&&(s=e.Height),o(s)},getOrCreateRow(t){let e=this.sheet.Rows[t+1];return e||(e={},Vue.set(this.sheet.Rows,t+1,e)),e},getOrCreateColumn(e){let s=t(e),i=this.sheet.Columns[s];return i||(i={},Vue.set(this.sheet.Columns,s,i)),i},selRect(t){let e=t.left,i=t.top,o=s,l={left:0,top:0,height:0,width:0};for(const t of this.renderedRows()){let e=this.rowHeight(t);if(t===i){l.top=o,l.height=e;break}if(t>i)break;o+=e}let r=this.startX;for(const t of this.renderedColumns()){let s=this.colWidth(t);if(t===e){l.left=r,l.width=s;break}if(t>e)break;r+=s}return l},pointFromEvent(t){let e=this.$refs.container.getBoundingClientRect(),s=t.clientY-e.top;return{x:t.clientX-e.left,y:s}},setPosX(t){this.scrollPos.x=t},setPosY(t){this.scrollPos.y=t},renderedRows:function*(){let t=this.sheet;for(let e=0;e<t.FixedRows;e++)yield e;for(let e=this.scrollPos.y;e<t.RowCount;e++)yield e},renderedColumns:function*(){let t=this.sheet;for(let e=0;e<t.FixedColumns;e++)yield e;for(let e=this.scrollPos.x;e<t.ColumnCount;e++)yield e},setPos(t,e){let s=this.selection;if(!s||!s.length)return;let i=s[0],o=this.sheet;o.Fixed,t<0&&(t=0),t>o.ColumnCount-1&&(t=o.ColumnCount-1),e<0&&(e=0),e>o.RowCount-1&&(e=o.RowCount-1),i.left=t,i.right=t+1,i.top=e,i.bottom=e+1,this.fitScrollPos()},mousewheel(t){let e=+(t.deltaY/100).toFixed();this.scrollPos.y=e>0?Math.min(this.scrollPos.y+e,this.sheet.RowCount-this.vScrollPageSize()):Math.max(this.scrollPos.y+e,this.sheet.FixedRows||0)},keydown(t){let e=this.selection;if(!e||!e.length)return;let s=e[0];switch(t.which){case 37:this.setPos(s.left-1,s.top);break;case 38:this.setPos(s.left,s.top-1);break;case 39:this.setPos(s.left+1,s.top);break;case 40:this.setPos(s.left,s.top+1);break;case 34:this.setPos(s.left,s.top+this.vScrollPageSize()+this.sheet.FixedRows);break;case 33:this.setPos(s.left,s.top-this.vScrollPageSize());break;case 36:this.setPos(0,s.top);break;case 35:this.setPos(this.sheet.Size.Columns-1,s.top);break;case 113:let e=this.selRect(s);this.doEdit({col:s.left,left:e.left,width:e.width},{row:s.top,top:e.top,heigth:e.height});break;default:console.dir(t.which)}},fitSpan(e,s){if(!e||!s)return;let i=`${t(e.col)}${s.row+1}`,o=this.sheet.Cells[i];if(o){if(o.ColSpan>1)for(let t=1;t<o.ColSpan;t++)e.width+=this.colWidth(e.col+t);if(o.RowSpan>1)for(let t=1;t<o.RowSpan;t++)s.height+=this.rowHeight(s.row+t)}},dblclick(t){if(t.srcElement.classList.contains("no-me"))return;let e=this.pointFromEvent(t),s=this.colFromPoint(e.x),i=this.rowFromPoint(e.y);this.fitSpan(s,i),this.doEdit(s,i)},endEdit(e){let s=this.editRect,i=`${t(s.c)}${s.r+1}`,o=this.sheet.Cells[i];if(!o){if(!e)return;o={Content:e},Vue.set(this.sheet.Cells,i,o)}Vue.set(o,"Value",e)},startEdit:(t,e)=>({control:"editor"}),cancelEdit(){this.editing=!1,this.editText=""},doEdit(e,s){if(!e||!s)return;if(!this.startEdit(t(e.col),s.row))return;let i=this.editRect;i.l=e.left,i.t=s.top,i.w=e.width,i.h=s.height,i.c=e.col,i.r=s.row;let o=this.sheet.Cells[`${t(e.col)}${s.row+1}`];this.editText=o?o.Value:"",this.editing=!0},$selectCell(t,e,s){this.sheet;let i=this.selection;this.selecting=!0,i.length=0;let o={left:t,top:e,right:t+(s.ColSpan||1),bottom:e+(s.RowSpan||1)};i.push(o)},pointerdown(t){if(t.srcElement.classList.contains("no-me"))return;t.target.setPointerCapture(t.pointerId),this.cancelEdit(),this.selecting=!0;let e=this.sheet,i=this.selection,o=this.pointFromEvent(t);if(o.x<this.startX){let t=this.rowFromPoint(o.y);i.length=0;let s={left:0,top:t.row,right:e.ColumnCount,bottom:t.row+1};i.push(s)}else if(o.y<s){let t=this.colFromPoint(o.x);i.length=0;let s={left:t.col,top:0,right:t.col+1,bottom:e.RowCount};i.push(s)}else{let t=this.createSelRect(o.x,o.y);t&&(i.length=0,i.push(t),this.selStart.x=t.left,this.selStart.y=t.top)}},pointermove(t){if(!this.selecting)return;if(t.srcElement.classList.contains("no-me"))return;let e=this.pointFromEvent(t),i=this.selection;if(!i||!i.length)return;let o=i[0];if(e.x<this.startX)this.rowFromPoint(e.y),console.dir("select rows");else if(e.y<s)this.colFromPoint(e.x),console.dir("select columns");else{let t=this.createSelRect(e.x,e.y);t.left==this.selStart.x&&(o.left=t.left,o.right=t.right),t.left<this.selStart.x?o.left=t.left:o.right=t.right,t.top==this.selStart.y?(o.top=t.top,o.bottom=t.bottom):t.top<this.selStart.y?o.top=t.top:o.bottom=t.bottom,this.fitScrollPos()}},pointerup(t){t.target.releasePointerCapture(t.pointerId),this.selecting=!1,this.selStart.x=0,this.selStart.y=0,this.fitScrollPos()},fitScrollPos(){let t=this.selection;if(!t||!t.length)return;let e=t[0],s=this.$refs.container,i=s.clientWidth-1,o=s.clientHeight-1,l={Rows:this.sheet.FixedRows||0,Columns:this.sheet.FixedColumns||0},r=this.scrollPos,n=null;if(r.y>l.Rows&&e.top<r.y)r.y=Math.max(e.top,l.Rows);else{n=n||this.selRect(e),n.top+n.height+1>o&&(r.y+=1)}if(r.x>l.Columns&&e.left<r.x)r.x=Math.max(e.left,l.Columns);else{n=n||this.selRect(e),n.left+n.width+1>i&&(r.x+=1)}},createSelRect(e,s){let i=this.rowFromPoint(s),o=this.colFromPoint(e);if(o&&i){let e=`${t(o.col)}${i.row+1}`,s=this.sheet.Cells[e];return{left:o.col,top:i.row,right:o.col+1+(s?.ColSpan-1||0),bottom:i.row+1+(s?.RowSpan-1||0)}}return null},isInSelection(e,s){return this.selection.some((s=>e(s,this.sheet.Cells[`${t(s.left)}${s.top+1}`])))},cellClass(t){return t?this.__sp.cellClass(t.Style):""},cellStyle(t){return t?this.__sp.cellStyle(t.Style):""},cellStyle2(t){return t?this.__sp.cellStyle2(t.Style):""},hScrollPageSize(){let t=this.$refs.container;if(!t)return 0;let e=this.startX,s=t.clientWidth,i=0,o=this.sheet.FixedColumns||0;for(let t of this.renderedColumns()){if(e+=this.colWidth(t),e>s)break;t>=o&&(i+=1)}return i},vScrollPageSize(){let t=this.$refs.container;if(!t)return 0;let e=s,i=t.clientHeight,o=0,l=this.sheet.FixedRows||0;for(let t of this.renderedRows()){if(e+=this.rowHeight(t),e>i)break;t>=l&&(o+=1)}return o},$getSelProp(e){let s=this.selection;if(!s||!s.length)return!1;let i=s[0],o=`${t(i.left)}${i.top+1}`,l=this.sheet.Cells[o];if(!l||!l.Style)return!1;let r=this.sheet.Styles[l.Style];return r&&r[e]||!1},$setSelProp(e,s){let i=this.selection;for(let o of function*(e){if(e&&e.length)for(let s of e)for(let e=s.top;e<s.bottom;e++)for(let i=s.left;i<s.right;i++)yield`${t(i)}${e+1}`}(i)){let t=this.sheet.Cells[o];t||(t={Value:s},Vue.set(this.sheet.Cells,o,t),t=this.sheet.Cells[o]),Vue.set(t,"Style",this.__sp.setStyleProp(t.Style,e,s))}return!0}},mounted(){this.updateCount+=1;this.selection.push({left:0,top:0,right:1,bottom:1}),this.scrollPos.x=this.sheet.FixedColumns||0,this.scrollPos.y=this.sheet.FixedRows||0,this.__ro=new ResizeObserver((t=>{this.updateCount+=1,this.fitScrollPos()})),this.__ro.observe(this.$el),this.__sp=new r(this.sheet.Styles),this.__mergeCells={};for(let e in this.sheet.Cells){let s=this.sheet.Cells[e];if(s.ColSpan>1||s.RowSpan>1){let o=i(e);if(s.RowSpan>1&&1==(s.ColSpan||1))for(let i=1;i<(s.RowSpan||1);i++)this.__mergeCells[`${t(o.c)}${i+o.r}`]=e;else if(s.ColSpan>1&&1==(s.RowSpan||1))for(let i=1;i<(s.ColSpan||1);i++)this.__mergeCells[`${t(i+o.c)}${o.r}`]=e;else for(let i=1;i<(s.ColSpan||1);i++)for(let l=1;l<(s.RowSpan||1);l++)this.__mergeCells[`${t(i+o.c)}${l+o.r}`]=e}}this.sheet.ColumnCount=Math.max(this.sheet.ColumnCount,26),this.sheet.RowCount=Math.max(this.sheet.RowCount,100)},beforeDestroy(){this.__ro&&this.__ro.unobserve(this.$el)}})}));
//# sourceMappingURL=a2v10spreadsheet.min.js.map
